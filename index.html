<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>æ‹çˆ±äººæ ¼å›¾é‰´</title>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
  background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 30%, #f0e6ff 70%, #ede9fe 100%);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  color: #374151;
  overflow-x: hidden;
}

.app {
  width: 100%;
  max-width: 420px;
  min-height: 100vh;
  position: relative;
}

/* ========== Screens ========== */
.screen {
  display: none;
  padding: 40px 24px;
  animation: fadeIn 0.5s ease;
}
.screen.active { display: flex; flex-direction: column; }

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.6); }
  to { opacity: 1; transform: scale(1); }
}
@keyframes slideUp {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}
@keyframes countUp {
  from { opacity: 0; transform: scale(0.3); }
  to { opacity: 1; transform: scale(1); }
}
@keyframes shimmer {
  0% { background-position: -200% center; }
  100% { background-position: 200% center; }
}

/* ========== Start Screen ========== */
.start-screen {
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  text-align: center;
}

.start-icon {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  background: linear-gradient(135deg, #f472b6, #a78bfa);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 48px;
  margin-bottom: 32px;
  animation: float 3s ease-in-out infinite;
  box-shadow: 0 12px 40px rgba(244, 114, 182, 0.3);
}

.start-screen h1 {
  font-size: 28px;
  font-weight: 800;
  background: linear-gradient(135deg, #ec4899, #8b5cf6);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 16px;
}

.start-screen .subtitle {
  font-size: 15px;
  color: #9ca3af;
  line-height: 1.8;
  margin-bottom: 40px;
}

.start-btn {
  width: 220px;
  height: 54px;
  border: none;
  border-radius: 27px;
  background: linear-gradient(135deg, #ec4899, #a855f7);
  color: white;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 8px 30px rgba(236, 72, 153, 0.4);
  transition: all 0.3s;
  letter-spacing: 2px;
}
.start-btn:active {
  transform: scale(0.96);
  box-shadow: 0 4px 15px rgba(236, 72, 153, 0.3);
}

.start-footer {
  margin-top: 48px;
  font-size: 12px;
  color: #d1d5db;
}

/* ========== Quiz Screen ========== */
.quiz-screen {
  min-height: 100vh;
  padding-top: 24px;
}

.progress-bar-wrap {
  width: 100%;
  height: 6px;
  background: rgba(255,255,255,0.5);
  border-radius: 3px;
  margin-bottom: 8px;
  overflow: hidden;
}
.progress-bar {
  height: 100%;
  background: linear-gradient(90deg, #ec4899, #a855f7);
  border-radius: 3px;
  transition: width 0.4s ease;
}

.progress-text {
  font-size: 13px;
  color: #9ca3af;
  text-align: right;
  margin-bottom: 32px;
}

.question-container {
  animation: fadeIn 0.4s ease;
}

.question-num {
  font-size: 14px;
  font-weight: 600;
  color: #a855f7;
  margin-bottom: 8px;
}

.question-text {
  font-size: 20px;
  font-weight: 700;
  color: #1f2937;
  line-height: 1.5;
  margin-bottom: 28px;
}

.options {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.option-btn {
  width: 100%;
  padding: 16px 20px;
  border: 2px solid rgba(168, 85, 247, 0.15);
  border-radius: 16px;
  background: rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(10px);
  font-size: 15px;
  color: #374151;
  text-align: left;
  cursor: pointer;
  transition: all 0.3s;
  line-height: 1.5;
}
.option-btn:active {
  transform: scale(0.98);
}
.option-btn.selected {
  border-color: #a855f7;
  background: linear-gradient(135deg, rgba(236,72,153,0.1), rgba(168,85,247,0.1));
  color: #7c3aed;
  font-weight: 600;
  box-shadow: 0 4px 15px rgba(168, 85, 247, 0.15);
}

/* ========== Loading Screen ========== */
.loading-screen {
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  text-align: center;
}

.loading-heart {
  font-size: 64px;
  animation: pulse 1s ease-in-out infinite;
  margin-bottom: 24px;
}

.loading-text {
  font-size: 16px;
  color: #9ca3af;
  line-height: 1.8;
}

.loading-dots::after {
  content: '';
  animation: dots 1.5s steps(3) infinite;
}
@keyframes dots {
  0% { content: ''; }
  33% { content: '.'; }
  66% { content: '..'; }
  100% { content: '...'; }
}

/* ========== Result Screen ========== */
.result-screen {
  align-items: center;
  min-height: 100vh;
  padding-top: 32px;
  padding-bottom: 40px;
}

.result-card {
  width: 100%;
  border-radius: 24px;
  padding: 36px 24px;
  text-align: center;
  position: relative;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0,0,0,0.08);
}

.result-card::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.3) 0%, transparent 60%);
  pointer-events: none;
}

.result-label {
  font-size: 13px;
  color: rgba(255,255,255,0.8);
  margin-bottom: 8px;
  letter-spacing: 3px;
}

.result-percentage {
  font-size: 72px;
  font-weight: 900;
  color: white;
  line-height: 1;
  margin-bottom: 4px;
  animation: countUp 0.8s ease-out;
  text-shadow: 0 4px 20px rgba(0,0,0,0.1);
}

.result-percentage-sign {
  font-size: 36px;
  font-weight: 700;
}

.result-type-icon {
  font-size: 48px;
  margin: 16px 0 8px;
  animation: scaleIn 0.6s ease 0.3s both;
}

.result-type-name {
  font-size: 26px;
  font-weight: 800;
  color: white;
  margin-bottom: 20px;
  animation: slideUp 0.5s ease 0.4s both;
}

.result-tags {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 8px;
  margin-bottom: 12px;
  animation: slideUp 0.5s ease 0.5s both;
}

.result-tag {
  padding: 6px 16px;
  border-radius: 20px;
  background: rgba(255,255,255,0.25);
  backdrop-filter: blur(10px);
  color: white;
  font-size: 13px;
  font-weight: 500;
}

.trait-tags {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 8px;
  margin-bottom: 0;
  animation: slideUp 0.5s ease 0.6s both;
}

.trait-tag {
  padding: 6px 16px;
  border-radius: 20px;
  border: 1.5px solid rgba(255,255,255,0.4);
  color: rgba(255,255,255,0.9);
  font-size: 12px;
  font-weight: 500;
}

/* Description card */
.desc-card {
  width: 100%;
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  padding: 24px;
  margin-top: 20px;
  text-align: left;
  box-shadow: 0 8px 30px rgba(0,0,0,0.04);
  animation: slideUp 0.5s ease 0.7s both;
}

.desc-card-title {
  font-size: 16px;
  font-weight: 700;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.desc-card p {
  font-size: 14px;
  line-height: 1.9;
  color: #4b5563;
}

/* Match info */
.match-card {
  width: 100%;
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  padding: 24px;
  margin-top: 12px;
  text-align: left;
  box-shadow: 0 8px 30px rgba(0,0,0,0.04);
  animation: slideUp 0.5s ease 0.8s both;
}

.match-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 0;
}
.match-row + .match-row {
  border-top: 1px solid rgba(0,0,0,0.05);
}
.match-emoji { font-size: 22px; }
.match-label { font-size: 13px; color: #9ca3af; min-width: 64px; }
.match-value { font-size: 14px; font-weight: 600; color: #374151; }

/* Buttons */
.result-actions {
  display: flex;
  gap: 12px;
  margin-top: 24px;
  width: 100%;
  animation: slideUp 0.5s ease 0.9s both;
}

.btn-retry, .btn-share {
  flex: 1;
  height: 48px;
  border-radius: 24px;
  border: none;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-retry {
  background: rgba(255,255,255,0.8);
  color: #6b7280;
  border: 1.5px solid #e5e7eb;
}
.btn-retry:active { transform: scale(0.96); }

.btn-share {
  background: linear-gradient(135deg, #ec4899, #a855f7);
  color: white;
  box-shadow: 0 6px 20px rgba(236, 72, 153, 0.3);
}
.btn-share:active { transform: scale(0.96); }

/* Toast */
.toast {
  position: fixed;
  top: 60px;
  left: 50%;
  transform: translateX(-50%) translateY(-20px);
  background: rgba(0,0,0,0.75);
  color: white;
  padding: 10px 24px;
  border-radius: 20px;
  font-size: 14px;
  opacity: 0;
  transition: all 0.3s;
  pointer-events: none;
  z-index: 100;
}
.toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

/* Color themes for result types */
.theme-healing { background: linear-gradient(135deg, #fbbf24, #f59e0b, #f97316); }
.theme-adventure { background: linear-gradient(135deg, #f97316, #ef4444, #ec4899); }
.theme-rational { background: linear-gradient(135deg, #06b6d4, #3b82f6, #6366f1); }
.theme-romantic { background: linear-gradient(135deg, #ec4899, #a855f7, #8b5cf6); }
.theme-guardian { background: linear-gradient(135deg, #10b981, #059669, #0d9488); }
.theme-soulmate { background: linear-gradient(135deg, #6366f1, #4f46e5, #7c3aed); }

/* ========== Share Card ========== */
.share-card {
  width: 100%;
  border-radius: 24px;
  padding: 32px 20px 20px;
  text-align: center;
  position: relative;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0,0,0,0.1);
}
.share-card::before {
  content: '';
  position: absolute;
  top: -50%; left: -50%;
  width: 200%; height: 200%;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 60%);
  pointer-events: none;
}
.share-card-inner { position: relative; z-index: 1; }
.share-rank {
  display: inline-block;
  padding: 4px 14px;
  border-radius: 12px;
  background: rgba(255,255,255,0.2);
  color: rgba(255,255,255,0.9);
  font-size: 12px;
  margin-bottom: 12px;
}
.share-pct {
  font-size: 64px;
  font-weight: 900;
  color: white;
  line-height: 1;
  animation: countUp 0.8s ease-out;
}
.share-pct-sign { font-size: 32px; }
.share-type-icon { font-size: 40px; margin: 10px 0 4px; }
.share-type-name {
  font-size: 24px;
  font-weight: 800;
  color: white;
  margin-bottom: 6px;
}
.share-quote {
  font-size: 13px;
  color: rgba(255,255,255,0.85);
  font-style: italic;
  margin-bottom: 16px;
  line-height: 1.6;
}
.share-tags {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 6px;
  margin-bottom: 16px;
}
.share-tag {
  padding: 4px 12px;
  border-radius: 14px;
  background: rgba(255,255,255,0.2);
  color: white;
  font-size: 12px;
}

/* Radar chart area */
.radar-wrap {
  display: flex;
  justify-content: center;
  margin: 8px 0 16px;
}
.radar-wrap canvas { max-width: 280px; max-height: 280px; }

/* Share card footer */
.share-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-top: 1px solid rgba(255,255,255,0.15);
  padding-top: 14px;
  margin-top: 4px;
}
.share-footer-brand {
  font-size: 11px;
  color: rgba(255,255,255,0.6);
  text-align: left;
  line-height: 1.5;
}
.share-footer-qr {
  width: 52px; height: 52px;
  background: white;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 9px;
  color: #666;
  text-align: center;
  line-height: 1.3;
}

/* Share CTA strip */
.share-cta {
  width: 100%;
  margin-top: 16px;
  padding: 14px;
  border-radius: 16px;
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(10px);
  text-align: center;
  animation: slideUp 0.4s ease 0.5s both;
}
.share-cta-text {
  font-size: 13px;
  color: #6b7280;
  margin-bottom: 10px;
}
.share-cta-btns {
  display: flex;
  gap: 10px;
}
.share-cta-btns button {
  flex: 1;
  height: 42px;
  border-radius: 21px;
  border: none;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}
.share-cta-btns button:active { transform: scale(0.96); }
.btn-save {
  background: linear-gradient(135deg, #ec4899, #a855f7);
  color: white;
  box-shadow: 0 4px 15px rgba(236,72,153,0.3);
}
.btn-retest {
  background: white;
  color: #6b7280;
  border: 1.5px solid #e5e7eb !important;
}

/* ========== Free Brief Section ========== */
.brief-section {
  width: 100%;
  margin-top: 16px;
  animation: slideUp 0.5s ease 0.6s both;
}
.brief-card {
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  padding: 20px;
  margin-bottom: 12px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.04);
}
.brief-card-title {
  font-size: 15px;
  font-weight: 700;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 6px;
}
.brief-card p {
  font-size: 13px;
  line-height: 1.8;
  color: #4b5563;
}
.brief-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 0;
}
.brief-row + .brief-row { border-top: 1px solid rgba(0,0,0,0.05); }
.brief-row .be { font-size: 20px; }
.brief-row .bl { font-size: 12px; color: #9ca3af; min-width: 56px; }
.brief-row .bv { font-size: 13px; font-weight: 600; color: #374151; flex: 1; }

/* ========== Paid Report Section ========== */
.paid-section {
  width: 100%;
  margin-top: 20px;
  animation: slideUp 0.5s ease 0.8s both;
}
.paid-header {
  text-align: center;
  margin-bottom: 16px;
}
.paid-header h3 {
  font-size: 18px;
  font-weight: 800;
  color: #1f2937;
  margin-bottom: 4px;
}
.paid-header p {
  font-size: 13px;
  color: #9ca3af;
}

/* Locked preview cards */
.locked-card {
  position: relative;
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  padding: 20px;
  margin-bottom: 12px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.04);
  overflow: hidden;
}
.locked-card.is-locked .locked-content {
  max-height: 80px;
  overflow: hidden;
  -webkit-mask-image: linear-gradient(to bottom, #000 20%, transparent 100%);
  mask-image: linear-gradient(to bottom, #000 20%, transparent 100%);
}
.locked-card.is-locked .lock-overlay {
  display: flex;
}
.lock-overlay {
  display: none;
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 70px;
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 14px;
}
.lock-badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 12px;
  border-radius: 12px;
  background: rgba(139,92,246,0.1);
  color: #7c3aed;
  font-size: 12px;
  font-weight: 600;
}

/* Unlock CTA */
.unlock-cta {
  width: 100%;
  border-radius: 20px;
  padding: 24px 20px;
  text-align: center;
  background: linear-gradient(135deg, #fdf2f8, #f0e6ff);
  border: 2px dashed rgba(168,85,247,0.25);
  margin-bottom: 12px;
}
.unlock-price-row {
  display: flex;
  align-items: baseline;
  justify-content: center;
  gap: 8px;
  margin-bottom: 4px;
}
.unlock-price {
  font-size: 32px;
  font-weight: 900;
  color: #7c3aed;
}
.unlock-price-orig {
  font-size: 14px;
  color: #d1d5db;
  text-decoration: line-through;
}
.unlock-limited {
  display: inline-block;
  padding: 2px 10px;
  border-radius: 8px;
  background: linear-gradient(135deg, #ec4899, #a855f7);
  color: white;
  font-size: 11px;
  font-weight: 600;
  margin-bottom: 12px;
}
.unlock-list {
  text-align: left;
  margin: 12px auto;
  max-width: 260px;
}
.unlock-list-item {
  font-size: 13px;
  color: #4b5563;
  padding: 3px 0;
  display: flex;
  align-items: center;
  gap: 6px;
}
.unlock-list-item::before {
  content: 'âœ“';
  color: #a855f7;
  font-weight: 700;
  font-size: 12px;
}
.unlock-btn {
  width: 100%;
  height: 52px;
  border: none;
  border-radius: 26px;
  background: linear-gradient(135deg, #ec4899, #a855f7);
  color: white;
  font-size: 17px;
  font-weight: 700;
  cursor: pointer;
  box-shadow: 0 8px 30px rgba(168,85,247,0.35);
  margin-top: 16px;
  transition: all 0.3s;
  letter-spacing: 1px;
}
.unlock-btn:active { transform: scale(0.97); }
.unlock-count {
  font-size: 12px;
  color: #9ca3af;
  margin-top: 10px;
}

/* ========== Unlocked Report ========== */
.report-unlocked { display: none; width: 100%; }
.report-unlocked.show { display: block; }
.report-card {
  background: rgba(255,255,255,0.9);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  padding: 20px;
  margin-bottom: 12px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.04);
  animation: slideUp 0.4s ease both;
}
.report-card-title {
  font-size: 15px;
  font-weight: 700;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 6px;
}
.report-item {
  display: flex;
  gap: 10px;
  padding: 8px 0;
  font-size: 13px;
  line-height: 1.7;
  color: #4b5563;
}
.report-item + .report-item { border-top: 1px solid rgba(0,0,0,0.04); }
.report-item-icon { font-size: 16px; flex-shrink: 0; padding-top: 2px; }
.report-item-text { flex: 1; }

/* Compatibility bars */
.compat-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 7px 0;
}
.compat-row + .compat-row { border-top: 1px solid rgba(0,0,0,0.04); }
.compat-name {
  font-size: 12px;
  color: #6b7280;
  min-width: 72px;
  white-space: nowrap;
}
.compat-bar-bg {
  flex: 1;
  height: 8px;
  background: #f3f4f6;
  border-radius: 4px;
  overflow: hidden;
}
.compat-bar {
  height: 100%;
  border-radius: 4px;
  transition: width 1s ease;
}
.compat-pct {
  font-size: 12px;
  font-weight: 700;
  min-width: 36px;
  text-align: right;
}

/* Report advice highlight */
.advice-box {
  padding: 14px;
  border-radius: 14px;
  background: linear-gradient(135deg, rgba(236,72,153,0.06), rgba(168,85,247,0.06));
  margin-bottom: 8px;
}
.advice-box:last-child { margin-bottom: 0; }
.advice-box-title {
  font-size: 13px;
  font-weight: 700;
  color: #7c3aed;
  margin-bottom: 6px;
}
.advice-box-text {
  font-size: 13px;
  line-height: 1.7;
  color: #4b5563;
}

/* Payment modal */
.pay-modal {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 200;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(4px);
}
.pay-modal.show { display: flex; }
.pay-modal-box {
  width: 300px;
  background: white;
  border-radius: 24px;
  padding: 32px 24px;
  text-align: center;
  animation: scaleIn 0.3s ease;
}
.pay-modal-icon { font-size: 48px; margin-bottom: 12px; }
.pay-modal-title { font-size: 18px; font-weight: 700; margin-bottom: 6px; }
.pay-modal-desc { font-size: 13px; color: #9ca3af; margin-bottom: 20px; }
.pay-modal-btn {
  width: 100%;
  height: 48px;
  border: none;
  border-radius: 24px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  margin-bottom: 8px;
  transition: all 0.3s;
}
.pay-modal-btn:active { transform: scale(0.97); }
.pay-modal-confirm {
  background: linear-gradient(135deg, #ec4899, #a855f7);
  color: white;
}
.pay-modal-cancel {
  background: #f3f4f6;
  color: #6b7280;
}

/* ========== Share Sheet ========== */
.share-sheet {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 200;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(4px);
  align-items: flex-end;
  justify-content: center;
}
.share-sheet.show { display: flex; }
.share-sheet-box {
  width: 100%;
  max-width: 420px;
  background: white;
  border-radius: 24px 24px 0 0;
  padding: 24px 20px 32px;
  animation: sheetUp 0.3s ease;
}
@keyframes sheetUp {
  from { transform: translateY(100%); }
  to { transform: translateY(0); }
}
.share-sheet-title {
  font-size: 16px;
  font-weight: 700;
  text-align: center;
  margin-bottom: 20px;
  color: #1f2937;
}
.share-platforms {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-bottom: 20px;
}
.share-platform {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  cursor: pointer;
  border: none;
  background: none;
  padding: 0;
}
.share-platform-icon {
  width: 52px;
  height: 52px;
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  transition: transform 0.2s;
}
.share-platform:active .share-platform-icon { transform: scale(0.92); }
.share-platform-name {
  font-size: 11px;
  color: #6b7280;
}
.sp-wechat { background: #07c160; }
.sp-red { background: #ff2442; }
.sp-douyin { background: #000; }
.sp-xianyu { background: #ffcd00; }

/* Share caption area */
.share-caption-area {
  display: none;
  background: #f9fafb;
  border-radius: 14px;
  padding: 14px;
  margin-bottom: 16px;
}
.share-caption-area.show { display: block; }
.share-caption-label {
  font-size: 12px;
  color: #9ca3af;
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.share-caption-text {
  font-size: 13px;
  line-height: 1.7;
  color: #374151;
  white-space: pre-line;
}
.share-copy-btn {
  font-size: 12px;
  color: #a855f7;
  background: none;
  border: 1px solid #a855f7;
  border-radius: 10px;
  padding: 2px 10px;
  cursor: pointer;
}
.share-copy-btn:active { background: rgba(168,85,247,0.1); }

/* Save image tip */
.share-img-tip {
  display: none;
  text-align: center;
  margin-bottom: 16px;
}
.share-img-tip.show { display: block; }
.share-img-tip img {
  max-width: 100%;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  margin-bottom: 8px;
}
.share-img-tip p {
  font-size: 12px;
  color: #9ca3af;
}

.share-sheet-cancel {
  width: 100%;
  height: 48px;
  border: none;
  border-radius: 24px;
  background: #f3f4f6;
  color: #6b7280;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
}
</style>
</head>
<body>

<div class="app">
  <!-- Start Screen -->
  <div class="screen start-screen active" id="startScreen">
    <div class="start-icon">ğŸ’•</div>
    <h1>æ‹çˆ±äººæ ¼å›¾é‰´</h1>
    <div class="subtitle">
      æ¯ä¸ªäººå¿ƒä¸­éƒ½è—ç€ä¸€ç§ç‹¬ç‰¹çš„çˆ±çš„æ–¹å¼<br>
      8é“é¢˜ï¼Œè§£é”ä½ çš„æ‹çˆ±äººæ ¼å¯†ç <br>
      å‘ç°ä½ åœ¨çˆ±æƒ…ä¸­çœŸå®çš„æ ·å­
    </div>
    <button class="start-btn" onclick="startQuiz()">å¼€å§‹æµ‹è¯•</button>
    <div class="start-footer">å·²æœ‰ 26,847 äººå®Œæˆæµ‹è¯•</div>
  </div>

  <!-- Quiz Screen -->
  <div class="screen quiz-screen" id="quizScreen">
    <div class="progress-bar-wrap">
      <div class="progress-bar" id="progressBar"></div>
    </div>
    <div class="progress-text" id="progressText"></div>
    <div class="question-container" id="questionContainer"></div>
  </div>

  <!-- Loading Screen -->
  <div class="screen loading-screen" id="loadingScreen">
    <div class="loading-heart">ğŸ’—</div>
    <div class="loading-text">
      æ­£åœ¨åˆ†æä½ çš„æ‹çˆ±äººæ ¼<span class="loading-dots"></span><br>
      <span style="font-size:13px; color:#d1d5db; margin-top:8px; display:inline-block;">AI æ·±åº¦è§£è¯»ä¸­</span>
    </div>
  </div>

  <!-- Result Screen -->
  <div class="screen result-screen" id="resultScreen"></div>
</div>

<div class="toast" id="toast"></div>

<!-- Share Sheet -->
<div class="share-sheet" id="shareSheet">
  <div class="share-sheet-box">
    <div class="share-sheet-title">åˆ†äº«åˆ°</div>
    <div class="share-platforms">
      <button class="share-platform" onclick="shareTo('wechat')">
        <div class="share-platform-icon sp-wechat"><span style="color:white">å¾®</span></div>
        <span class="share-platform-name">å¾®ä¿¡</span>
      </button>
      <button class="share-platform" onclick="shareTo('red')">
        <div class="share-platform-icon sp-red"><span style="color:white">çº¢</span></div>
        <span class="share-platform-name">å°çº¢ä¹¦</span>
      </button>
      <button class="share-platform" onclick="shareTo('douyin')">
        <div class="share-platform-icon sp-douyin"><span style="color:white">æŠ–</span></div>
        <span class="share-platform-name">æŠ–éŸ³</span>
      </button>
      <button class="share-platform" onclick="shareTo('xianyu')">
        <div class="share-platform-icon sp-xianyu"><span style="color:#333">é±¼</span></div>
        <span class="share-platform-name">é—²é±¼</span>
      </button>
    </div>
    <div class="share-img-tip" id="shareImgTip">
      <img id="shareImgPreview" src="" alt="åˆ†äº«å›¾">
      <p>é•¿æŒ‰å›¾ç‰‡ä¿å­˜åˆ°ç›¸å†Œï¼Œç„¶åå»å¯¹åº”Appå‘å¸ƒ</p>
    </div>
    <div class="share-caption-area" id="shareCaptionArea">
      <div class="share-caption-label">
        <span id="shareCaptionLabel">æ¨èæ–‡æ¡ˆ</span>
        <button class="share-copy-btn" onclick="copyCaption()">å¤åˆ¶æ–‡æ¡ˆ</button>
      </div>
      <div class="share-caption-text" id="shareCaptionText"></div>
    </div>
    <button class="share-sheet-cancel" onclick="closeShare()">å–æ¶ˆ</button>
  </div>
</div>

<!-- Payment Modal: QR Code -->
<div class="pay-modal" id="payModal">
  <div class="pay-modal-box" id="payModalContent">
    <!-- QR Pay View (default) -->
    <div id="qrPayView">
      <div style="font-size:13px;color:#9ca3af;margin-bottom:8px;">å¾®ä¿¡æ‰«ç æ”¯ä»˜</div>
      <img src="pay-qr.jpg" style="width:200px;height:200px;border-radius:12px;object-fit:cover;margin-bottom:8px;">
      <div style="font-size:22px;font-weight:800;color:#1f2937;margin-bottom:12px;">Â¥1.99</div>
      <button class="pay-modal-btn pay-modal-confirm" onclick="confirmPaid()">æˆ‘å·²æ”¯ä»˜ï¼Œè§£é”æŠ¥å‘Š</button>
      <button class="pay-modal-btn pay-modal-cancel" onclick="closePay()">ç¨åå†è¯´</button>
    </div>
  </div>
</div>

<script>
// ===== Radar Chart =====
function drawRadar(canvasId, scoresObj, themeColor) {
  const canvas = document.getElementById(canvasId);
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const W = 280, H = 280, cx = W/2, cy = H/2, R = 72;
  canvas.width = W * 2; canvas.height = H * 2;
  canvas.style.width = W+'px'; canvas.style.height = H+'px';
  ctx.scale(2, 2);

  const labels = ['æ²»æ„ˆÂ·å°å¤ªé˜³å€¼','å†’é™©Â·å¿ƒåŠ¨åˆ¶é€ åŠ›','ç†æ™ºÂ·æ¸…é†’æµ“åº¦','æµªæ¼«Â·ç²‰çº¢æ³¡æ³¡','å®ˆæŠ¤Â·é“ ç”²åšåº¦','çµé­‚Â·ç¬¬å…­æ„Ÿ'];
  const keys = ['healing','adventure','rational','romantic','guardian','soulmate'];
  const maxS = Math.max(...Object.values(scoresObj), 1);
  const vals = keys.map(k => (scoresObj[k]||0)/maxS);
  const n = 6;

  // grid
  for (let ring = 1; ring <= 3; ring++) {
    const r = R * ring / 3;
    ctx.beginPath();
    for (let i = 0; i <= n; i++) {
      const a = Math.PI*2*i/n - Math.PI/2;
      const x = cx + r*Math.cos(a), y = cy + r*Math.sin(a);
      i === 0 ? ctx.moveTo(x,y) : ctx.lineTo(x,y);
    }
    ctx.closePath();
    ctx.strokeStyle = 'rgba(255,255,255,0.2)';
    ctx.lineWidth = 1;
    ctx.stroke();
  }
  // axes
  for (let i = 0; i < n; i++) {
    const a = Math.PI*2*i/n - Math.PI/2;
    ctx.beginPath();
    ctx.moveTo(cx, cy);
    ctx.lineTo(cx + R*Math.cos(a), cy + R*Math.sin(a));
    ctx.strokeStyle = 'rgba(255,255,255,0.15)';
    ctx.stroke();
  }
  // data shape
  ctx.beginPath();
  for (let i = 0; i <= n; i++) {
    const idx = i % n;
    const a = Math.PI*2*idx/n - Math.PI/2;
    const v = 0.2 + vals[idx]*0.8;
    const x = cx + R*v*Math.cos(a), y = cy + R*v*Math.sin(a);
    i === 0 ? ctx.moveTo(x,y) : ctx.lineTo(x,y);
  }
  ctx.closePath();
  ctx.fillStyle = 'rgba(255,255,255,0.2)';
  ctx.fill();
  ctx.strokeStyle = 'rgba(255,255,255,0.8)';
  ctx.lineWidth = 2;
  ctx.stroke();
  // dots + labels
  for (let i = 0; i < n; i++) {
    const a = Math.PI*2*i/n - Math.PI/2;
    const v = 0.2 + vals[i]*0.8;
    const x = cx + R*v*Math.cos(a), y = cy + R*v*Math.sin(a);
    ctx.beginPath();
    ctx.arc(x,y,3,0,Math.PI*2);
    ctx.fillStyle = 'white';
    ctx.fill();
    const lx = cx + (R+32)*Math.cos(a), ly = cy + (R+32)*Math.sin(a);
    ctx.fillStyle = 'rgba(255,255,255,0.85)';
    ctx.font = '600 10px -apple-system, sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(labels[i], lx, ly);
  }
}

// ===== Data =====
const questions = [
  {
    q: "çº¦ä¼šæ—¶ï¼Œä½ æœ€æœŸå¾…çš„ç¯èŠ‚æ˜¯ï¼Ÿ",
    opts: [
      { text: "ä¸€èµ·å°è¯•æ²¡åšè¿‡çš„äº‹ï¼Œæ¯”å¦‚æ”€å²©ã€å¯†å®¤é€ƒè„±", scores: { adventure: 2 } },
      { text: "æ‰¾ä¸ªèˆ’æœçš„åœ°æ–¹ï¼Œå®‰é™å¾…åœ¨ä¸€èµ·å°±å¾ˆå¹¸ç¦", scores: { healing: 2 } },
      { text: "ç²¾å¿ƒç­–åˆ’çš„æµªæ¼«æƒŠå–œï¼Œçƒ›å…‰æ™šé¤æˆ–æ‰‹å†™ä¿¡", scores: { romantic: 2 } },
      { text: "æ·±å…¥èŠèŠå½¼æ­¤çš„æƒ³æ³•ï¼Œè¶ŠèŠè¶Šæœ‰ç«èŠ±", scores: { soulmate: 2 } }
    ]
  },
  {
    q: "å’Œä¼´ä¾£äº§ç”ŸçŸ›ç›¾åï¼Œä½ é€šå¸¸ä¼šï¼Ÿ",
    opts: [
      { text: "å…ˆå†·é™ä¸‹æ¥ï¼Œç†æ€§åˆ†æé—®é¢˜å‡ºåœ¨å“ªé‡Œ", scores: { rational: 2 } },
      { text: "ä¸»åŠ¨ç¤ºå¥½ï¼Œä¸å¿å¿ƒçœ‹å¯¹æ–¹éš¾è¿‡", scores: { healing: 2 } },
      { text: "éœ€è¦ç‹¬å¤„çš„ç©ºé—´æ¥æ¶ˆåŒ–æƒ…ç»ªå’Œæ€è€ƒ", scores: { soulmate: 1, rational: 1 } },
      { text: "å†™ä¸€æ®µé•¿é•¿çš„è¯å‘ç»™å¯¹æ–¹ï¼Œè¡¨è¾¾å†…å¿ƒæ„Ÿå—", scores: { romantic: 2 } }
    ]
  },
  {
    q: "ä½ ç†æƒ³ä¸­çš„æ‹çˆ±çŠ¶æ€æ˜¯ï¼Ÿ",
    opts: [
      { text: "ç›¸äº’ç‹¬ç«‹åˆå½¼æ­¤æ”¯æŒï¼Œå„è‡ªç²¾å½©ä¹Ÿå…±åŒæˆé•¿", scores: { rational: 2 } },
      { text: "æ°¸è¿œæœ‰æ–°é²œæ„Ÿï¼Œä¸€èµ·åˆ›é€ åˆºæ¿€çš„å›å¿†", scores: { adventure: 2 } },
      { text: "ç¨³ç¨³çš„å¹¸ç¦ï¼ŒæŸ´ç±³æ²¹ç›ä¹Ÿè§‰å¾—æµªæ¼«", scores: { guardian: 2 } },
      { text: "çµé­‚æ·±å¤„çš„å…±é¸£ï¼Œä¸€ä¸ªçœ¼ç¥å°±èƒ½æ‡‚å½¼æ­¤", scores: { soulmate: 2 } }
    ]
  },
  {
    q: "ä½ æœ€çœ‹é‡ä¼´ä¾£èº«ä¸Šçš„ä»€ä¹ˆç‰¹è´¨ï¼Ÿ",
    opts: [
      { text: "æƒ…ç»ªç¨³å®šï¼Œæ— è®ºä½•æ—¶éƒ½è®©äººæ„Ÿåˆ°å®‰å¿ƒ", scores: { guardian: 2 } },
      { text: "æœ‰è¶£åˆå……æ»¡æ´»åŠ›ï¼Œå’ŒTAåœ¨ä¸€èµ·æ°¸è¿œä¸æ— èŠ", scores: { adventure: 1, soulmate: 1 } },
      { text: "æ¸©æŸ”ä½“è´´ï¼Œæ€»èƒ½åœ¨ç»†èŠ‚å¤„ç…§é¡¾åˆ°ä½ ", scores: { healing: 2 } },
      { text: "æœ‰å“ä½ã€æ‡‚æµªæ¼«ï¼Œèƒ½æŠŠæ—¥å­è¿‡æˆè¯—", scores: { romantic: 2 } }
    ]
  },
  {
    q: "æ”¶åˆ°ä¼´ä¾£çš„ç¤¼ç‰©æ—¶ï¼Œä½ æ›´åœ¨æ„ä»€ä¹ˆï¼Ÿ",
    opts: [
      { text: "å®ç”¨åˆè´´å¿ƒï¼Œè¯´æ˜TAäº†è§£ä½ çš„éœ€æ±‚", scores: { rational: 1, guardian: 1 } },
      { text: "æœ‰æƒŠå–œæ„Ÿå’Œä»ªå¼æ„Ÿï¼Œæ‹†ç¤¼ç‰©çš„ç¬é—´æœ€ç¾", scores: { romantic: 2 } },
      { text: "TAè®°ä½äº†ä½ æ— æ„é—´è¯´è¿‡çš„è¯ï¼Œè¿™æ¯”ä»€ä¹ˆéƒ½çè´µ", scores: { soulmate: 2 } },
      { text: "åªè¦æ˜¯TAé€çš„å°±å¾ˆå¼€å¿ƒï¼Œç¤¼è½»æƒ…æ„é‡", scores: { healing: 2 } }
    ]
  },
  {
    q: "ä¸‹é¢å“ªå¥è¯æœ€æ¥è¿‘ä½ çš„çˆ±æƒ…è§‚ï¼Ÿ",
    opts: [
      { text: "çˆ±æƒ…æ˜¯é”¦ä¸Šæ·»èŠ±ï¼Œå…ˆçˆ±è‡ªå·±æ‰èƒ½å¥½å¥½çˆ±åˆ«äºº", scores: { rational: 2 } },
      { text: "çˆ±æƒ…æ˜¯ä¸€åœºå¥‡å¦™çš„å†’é™©ï¼Œå°±è¦è½°è½°çƒˆçƒˆ", scores: { adventure: 2 } },
      { text: "çˆ±æƒ…æ˜¯æ‰¾åˆ°çµé­‚çš„å¦ä¸€åŠï¼Œå®ç¼ºæ¯‹æ»¥", scores: { soulmate: 2 } },
      { text: "çˆ±æƒ…æ˜¯ç›¸äº’å®ˆæŠ¤çš„æ‰¿è¯ºï¼Œå¹³æ·¡ä¸­è§çœŸæƒ…", scores: { guardian: 2 } }
    ]
  },
  {
    q: "å‘¨æœ«å’Œä¼´ä¾£åœ¨ä¸€èµ·ï¼Œä½ æœ€æƒ³åšä»€ä¹ˆï¼Ÿ",
    opts: [
      { text: "ä¸€èµ·å®…å®¶çœ‹ç”µå½±ã€åšé¡¿å¥½åƒçš„", scores: { guardian: 1, healing: 1 } },
      { text: "å»æ²¡å»è¿‡çš„åœ°æ–¹æ¢ç´¢ï¼Œæ¥ä¸€åœºè¯´èµ°å°±èµ°çš„æ—…è¡Œ", scores: { adventure: 2 } },
      { text: "ä¸€èµ·é€›å±•ã€é€›ä¹¦åº—ï¼Œäº¤æ¢å½¼æ­¤çš„æƒ³æ³•", scores: { soulmate: 1, rational: 1 } },
      { text: "å»æ‹ç…§æ‰“å¡ï¼Œä¸€èµ·è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´", scores: { romantic: 2 } }
    ]
  },
  {
    q: "é¢å¯¹æš§æ˜§æœŸï¼Œä½ çš„æ€åº¦æ˜¯ï¼Ÿ",
    opts: [
      { text: "å¥½å¥½äº«å—è¿™ç§å¿ƒåŠ¨çš„æ„Ÿè§‰ï¼Œæš§æ˜§æ˜¯æœ€ç¾çš„é˜¶æ®µ", scores: { romantic: 2 } },
      { text: "å–œæ¬¢å°±ç›´è¯´ï¼Œä¸å–œæ¬¢æ‹–æ³¥å¸¦æ°´", scores: { adventure: 1, rational: 1 } },
      { text: "é»˜é»˜è§‚å¯Ÿï¼Œç¡®è®¤å¯¹æ–¹åˆé€‚äº†å†å¾€å‰èµ°", scores: { rational: 1, guardian: 1 } },
      { text: "ä¸å–„è¨€è¾ï¼Œä½†ä¼šç”¨è¡ŒåŠ¨é»˜é»˜å…³å¿ƒå¯¹æ–¹", scores: { healing: 1, guardian: 1 } }
    ]
  }
];

const types = {
  healing: {
    name: "æ²»æ„ˆç³»æ‹äºº", icon: "â˜€ï¸", theme: "theme-healing",
    tags: ["æ¸©æš–å¦‚å…‰", "å–„è§£äººæ„", "æƒ…ç»ªæ¸¯æ¹¾"],
    traits: ["å…±æƒ…åŠ›MAX", "åŒ…å®¹åŠ›å¼º", "ç»†è…»æ¸©æŸ”"],
    quote: "ã€Œæˆ‘çš„æ¸©æŸ”ï¼Œæ˜¯åªä¸ºä½ å‡†å¤‡çš„é¿é£æ¸¯ã€",
    desc: "ä½ æ˜¯æ‹çˆ±ä¸­çš„ä¸€æŸæš–é˜³ã€‚ä½ å¤©ç”Ÿæ‹¥æœ‰æ„ŸçŸ¥ä»–äººæƒ…ç»ªçš„èƒ½åŠ›ï¼Œæ€»æ˜¯åœ¨å¯¹æ–¹æœ€éœ€è¦çš„æ—¶å€™ç»™äºˆæ°åˆ°å¥½å¤„çš„æ¸©æš–ã€‚ä½ çš„çˆ±ä¸å¼ æ‰¬å´æ— æ¯”æ·±æ²‰ï¼Œåƒæ˜¥é£åŒ–é›¨èˆ¬æ¸—é€åˆ°ç”Ÿæ´»çš„æ¯ä¸€ä¸ªç»†èŠ‚ã€‚å’Œä½ åœ¨ä¸€èµ·çš„äººï¼Œä¼šè§‰å¾—è¢«å…¨ä¸–ç•Œæ¸©æŸ”ä»¥å¾…ã€‚",
    bestMatch: "å†’é™©ç³»æ‹äºº",
    bestMatchWhy: "ä½ çš„æ¸©æš–æ°å¥½èƒ½åŒ…å®¹TAçš„ä¸å®‰åˆ†ï¼ŒTAçš„æ´»åŠ›åˆèƒ½å¸¦ä½ çœ‹æ›´å¤§çš„ä¸–ç•Œ",
    loveLanguage: "é»˜é»˜ä»˜å‡ºå‹", keyword: "è®©ä½ å®‰å¿ƒ",
    strengths: ["æå¼ºçš„æƒ…ç»ªæ„ŸçŸ¥åŠ›ï¼Œæ€»èƒ½å¯Ÿè§‰å¯¹æ–¹çš„æƒ…ç»ªå˜åŒ–", "åŒ…å®¹åŠ›å¼ºï¼Œèƒ½æ¥çº³ä¼´ä¾£çš„ä¸å®Œç¾", "å–„äºè¥é€ æ¸©é¦¨èˆ’é€‚çš„äº²å¯†æ°›å›´"],
    blindSpots: ["å®¹æ˜“å¿½è§†è‡ªå·±çš„éœ€æ±‚ï¼Œä¹ æƒ¯æ€§ä»˜å‡º", "å¯èƒ½å› ä¸ºè¿‡åº¦åŒ…å®¹è€Œå¤±å»è‡ªæˆ‘è¾¹ç•Œ"],
    compatibility: { healing: 72, adventure: 92, rational: 68, romantic: 78, guardian: 85, soulmate: 74 },
    advice: [
      { title: "å­¦ä¼šè¡¨è¾¾è‡ªå·±çš„éœ€æ±‚", text: "ä½ ä¹ æƒ¯äº†ç…§é¡¾åˆ«äººï¼Œä½†å¥½çš„çˆ±æƒ…æ˜¯åŒå‘çš„ã€‚è¯•ç€å‘Šè¯‰å¯¹æ–¹ã€Œæˆ‘ä»Šå¤©ä¹Ÿéœ€è¦ä¸€ä¸ªæ‹¥æŠ±ã€ï¼Œä½ å€¼å¾—è¢«åŒæ ·æ¸©æŸ”åœ°å¯¹å¾…ã€‚" },
      { title: "å»ºç«‹å¥åº·çš„è¾¹ç•Œæ„Ÿ", text: "åŒ…å®¹ä¸ç­‰äºæ²¡æœ‰åº•çº¿ã€‚æ˜ç¡®ä»€ä¹ˆæ˜¯ä½ å¯ä»¥æ¥å—çš„ã€ä»€ä¹ˆä¸è¡Œï¼Œè¿™ä¸æ˜¯è‡ªç§ï¼Œæ˜¯å¯¹å…³ç³»è´Ÿè´£ã€‚" },
      { title: "å…è®¸è‡ªå·±å¶å°”è„†å¼±", text: "ä½ ä¸å¿…æ°¸è¿œåšé‚£ä¸ªåšå¼ºçš„äººã€‚åœ¨å¯¹çš„äººé¢å‰å¸ä¸‹ç›”ç”²ï¼Œä¼šè®©å…³ç³»æ›´äº²å¯†ã€‚" }
    ]
  },
  adventure: {
    name: "å†’é™©ç³»æ‹äºº", icon: "ğŸ”¥", theme: "theme-adventure",
    tags: ["çƒ­æƒ…ä¼¼ç«", "è‡ªç”±ä¸ç¾", "æ°¸è¿œå¿ƒåŠ¨"],
    traits: ["å……æ»¡æ´»åŠ›", "æ•¢çˆ±æ•¢æ¨", "çµé­‚æœ‰è¶£"],
    quote: "ã€Œçˆ±æƒ…å°±è¯¥æ˜¯ä¸€åœºæ°¸ä¸æ•£åœºçš„çƒŸç«ã€",
    desc: "ä½ çš„çˆ±æƒ…åƒä¸€åœºæ°¸ä¸è½å¹•çš„çƒŸç«ã€‚ä½ ç›¸ä¿¡çˆ±å°±è¦è½°è½°çƒˆçƒˆï¼Œè®¨åŒä¸€æˆä¸å˜çš„æ—¥å­ã€‚ä½ æ°¸è¿œæ˜¯é‚£ä¸ªä¸»åŠ¨åˆ¶é€ æƒŠå–œçš„äººï¼Œä¹Ÿæ˜¯å…³ç³»ä¸­çš„ã€Œå¿«ä¹æºæ³‰ã€ã€‚å¯¹ä½ æ¥è¯´ï¼Œæœ€å¥½çš„çˆ±æƒ…æ˜¯å’Œä¸€ä¸ªäººä¸€èµ·æ¢ç´¢è¿™ä¸ªä¸–ç•Œï¼ŒæŠŠæ¯ä¸€å¤©éƒ½æ´»æˆå†’é™©æ•…äº‹ã€‚",
    bestMatch: "æ²»æ„ˆç³»æ‹äºº",
    bestMatchWhy: "TAçš„æ¸©æŸ”æ˜¯ä½ å†’é™©å½’æ¥çš„é¿é£æ¸¯ï¼Œä½ çš„çƒ­æƒ…åˆèƒ½ç‚¹ç‡ƒTAå¹³é™çš„ç”Ÿæ´»",
    loveLanguage: "åˆ¶é€ æƒŠå–œå‹", keyword: "å’Œä½ åœ¨ä¸€èµ·æ°¸è¿œä¸æ— èŠ",
    strengths: ["è‡ªå¸¦æ„ŸæŸ“åŠ›ï¼Œèƒ½è®©å¹³æ·¡çš„å…³ç³»å……æ»¡æ´»åŠ›", "è¡ŒåŠ¨åŠ›å¼ºï¼Œæƒ³åˆ°å°±åšï¼Œæ°¸è¿œæ˜¯æƒŠå–œåˆ¶é€ æœº", "å‹‡æ•¢çœŸè¯šï¼Œæ•¢äºè¡¨è¾¾çˆ±æ„ä¸é®æ©"],
    blindSpots: ["å¯èƒ½å› è¿½æ±‚æ–°é²œæ„Ÿè€Œå¿½ç•¥å…³ç³»ä¸­éœ€è¦è€å¿ƒç»è¥çš„éƒ¨åˆ†", "çƒ­æƒ…æ¥å¾—å¿«ä¹Ÿå¯èƒ½é€€å¾—å¿«ï¼Œéœ€è¦å­¦ä¼šåœ¨å¹³æ·¡ä¸­æ‰¾åˆ°æµªæ¼«"],
    compatibility: { healing: 92, adventure: 65, rational: 70, romantic: 82, guardian: 74, soulmate: 78 },
    advice: [
      { title: "åœ¨æ¿€æƒ…ä¸­å­¦ä¼šæ²‰æ·€", text: "æ¿€æƒ…æ˜¯çˆ±æƒ…çš„ç«èŠ±ï¼Œä½†çœŸæ­£çš„æ·±åº¦æ¥è‡ªå®‰é™ç›¸å¤„çš„æ—¶åˆ»ã€‚è¯•ç€å’Œå¯¹æ–¹ä¸€èµ·äº«å—ä¸€ä¸ªå®‰é™çš„ä¸‹åˆï¼Œä½ ä¼šå‘ç°ä¸ä¸€æ ·çš„ç”œèœœã€‚" },
      { title: "å€¾å¬æ¯”è¡ŒåŠ¨æ›´é‡è¦", text: "ä½ æ€»æ˜¯æ€¥äºç”¨è¡ŒåŠ¨è¡¨è¾¾çˆ±ï¼Œä½†æœ‰æ—¶å€™å¯¹æ–¹éœ€è¦çš„åªæ˜¯ä½ å®‰é™åœ°å¬TAè¯´ã€‚æ”¾æ…¢è„šæ­¥ï¼Œå­¦ä¼šåœ¨å€¾å¬ä¸­ç»™äºˆåŠ›é‡ã€‚" },
      { title: "æ¥å—å…³ç³»ä¸­çš„å¹³æ·¡æœŸ", text: "ä¸æ˜¯æ¯å¤©éƒ½è¦è½°è½°çƒˆçƒˆã€‚å¹³æ·¡ä¸æ˜¯æ„Ÿæƒ…å˜æ·¡ï¼Œè€Œæ˜¯ä½ ä»¬å¼€å§‹æœ‰äº†å®‰å…¨æ„Ÿçš„ä¿¡å·ã€‚" }
    ]
  },
  rational: {
    name: "ç†æ™ºç³»æ‹äºº", icon: "ğŸ’", theme: "theme-rational",
    tags: ["æ¸…é†’ç‹¬ç«‹", "è¾¹ç•Œåˆ†æ˜", "é«˜è´¨é‡é™ªä¼´"],
    traits: ["ç†æ€§æ€è€ƒ", "è‡ªæˆ‘å®Œæ•´", "æˆç†Ÿç¨³é‡"],
    quote: "ã€Œæœ€å¥½çš„çˆ±æƒ…ï¼Œæ˜¯ä¸¤ä¸ªå®Œæ•´çš„äººç›¸äº’æˆå°±ã€",
    desc: "ä½ æ˜¯æ‹çˆ±ä¸­æœ€æ¸…é†’çš„å­˜åœ¨ã€‚ä½ æ·±çŸ¥å¥½çš„çˆ±æƒ…ä¸æ˜¯å¤±å»è‡ªæˆ‘ï¼Œè€Œæ˜¯ä¸¤ä¸ªå®Œæ•´çš„äººç›¸äº’æˆå°±ã€‚ä½ ä¸ä¼šå› ä¸ºæ‹çˆ±å°±æ”¾å¼ƒè‡ªå·±çš„ç”Ÿæ´»å’Œè¿½æ±‚ï¼Œä¹Ÿä¸ä¼šç”¨æƒ…ç»ªç»‘æ¶æ¥ç»´ç³»å…³ç³»ã€‚ä½ æä¾›çš„æ˜¯é«˜è´¨é‡çš„é™ªä¼´å’Œæ·±æ€ç†Ÿè™‘çš„çˆ±ï¼Œè™½ç„¶ä¸è½°çƒˆï¼Œä½†æ¯ä¸€åˆ†éƒ½çœŸå®è€Œå¯é ã€‚",
    bestMatch: "æµªæ¼«ç³»æ‹äºº",
    bestMatchWhy: "TAçš„æµªæ¼«èƒ½èåŒ–ä½ ç†æ€§çš„å¤–å£³ï¼Œä½ çš„ç¨³é‡åˆèƒ½è®©TAçš„æ„Ÿæ€§æœ‰å¤„å®‰æ”¾",
    loveLanguage: "é«˜è´¨é‡é™ªä¼´å‹", keyword: "å’Œä½ åœ¨ä¸€èµ·æœ‰å®‰å…¨æ„Ÿ",
    strengths: ["æƒ…ç»ªç¨³å®šï¼Œæ˜¯å…³ç³»ä¸­çš„ã€Œå®šæµ·ç¥é’ˆã€", "å–„äºæ²Ÿé€šè§£å†³é—®é¢˜ï¼Œä¸ä¼šè®©çŸ›ç›¾ç§¯å‹", "å°Šé‡å½¼æ­¤ç‹¬ç«‹ç©ºé—´ï¼Œå…³ç³»å¥åº·æœ‰æ´»åŠ›"],
    blindSpots: ["æœ‰æ—¶è¿‡äºç†æ€§ï¼Œå¯¹æ–¹ä¼šè§‰å¾—ä½ ã€Œä¸å¤Ÿçƒ­æƒ…ã€æˆ–ã€Œå¤ªå†·é™ã€", "å¯èƒ½åœ¨å¯¹æ–¹éœ€è¦æ„Ÿæ€§å›åº”æ—¶ï¼Œç»™å‡ºç†æ€§åˆ†æ"],
    compatibility: { healing: 68, adventure: 70, rational: 60, romantic: 90, guardian: 75, soulmate: 82 },
    advice: [
      { title: "å¶å°”è®©æ„Ÿæ€§å¸¦è·¯", text: "ä¸æ˜¯æ‰€æœ‰äº‹æƒ…éƒ½éœ€è¦åˆ†æåˆ©å¼Šã€‚ä¸‹æ¬¡æƒ³è¯´ã€Œæˆ‘çˆ±ä½ ã€çš„æ—¶å€™ï¼Œåˆ«åœ¨å¿ƒé‡Œåˆ—proså’Œconsäº†ï¼Œç›´æ¥è¯´å‡ºæ¥ã€‚" },
      { title: "ä¸»åŠ¨åˆ¶é€ äº²å¯†æ—¶åˆ»", text: "ä½ çš„çˆ±è—åœ¨ç»†èŠ‚é‡Œä½†ä¸å¤Ÿå¤–æ˜¾ã€‚è¯•ç€ä¸»åŠ¨ç‰µæ‰‹ã€çªç„¶æ‹¥æŠ±ï¼Œè¿™äº›å°åŠ¨ä½œå¯¹å¯¹æ–¹æ¥è¯´æ„ä¹‰é‡å¤§ã€‚" },
      { title: "åœ¨ç†è§£ä¹‹å‰å…ˆå…±æƒ…", text: "å¯¹æ–¹å€¾è¯‰çƒ¦æ¼æ—¶ï¼ŒTAå¯èƒ½ä¸éœ€è¦è§£å†³æ–¹æ¡ˆï¼Œåªéœ€è¦ä¸€å¥ã€Œæˆ‘ç†è§£ä½ ã€ã€‚å…ˆæ‹¥æŠ±ï¼Œå†åˆ†æã€‚" }
    ]
  },
  romantic: {
    name: "æµªæ¼«ç³»æ‹äºº", icon: "ğŸŒ™", theme: "theme-romantic",
    tags: ["ä»ªå¼æ„Ÿæ»¡åˆ†", "å®¡ç¾åœ¨çº¿", "æµªæ¼«è‡³ä¸Š"],
    traits: ["æ„Ÿæ€§ç»†è…»", "å–„äºè¡¨è¾¾", "æ°›å›´æ„Ÿå¤§å¸ˆ"],
    quote: "ã€Œå’Œä½ çš„æ¯ä¸€å¤©ï¼Œéƒ½å€¼å¾—è¢«å†™è¿›æƒ…ä¹¦é‡Œã€",
    desc: "ä½ æŠŠçˆ±æƒ…å½“ä½œä¸€é¦–éœ€è¦ç”¨å¿ƒè°±å†™çš„è¯—ã€‚åœ¨ä½ çš„ä¸–ç•Œé‡Œï¼Œæ¯ä¸€ä¸ªçºªå¿µæ—¥éƒ½å€¼å¾—åº†ç¥ï¼Œæ¯ä¸€æ¬¡å¿ƒåŠ¨éƒ½å€¼å¾—è¢«è®°å½•ã€‚ä½ å–„äºç”¨æ–‡å­—ã€ç”»é¢å’Œä»ªå¼æ¥è¡¨è¾¾çˆ±æ„ï¼Œä¹ŸæœŸå¾…å¯¹æ–¹èƒ½æ‡‚ä½ è¿™ä»½å¯¹ç¾å¥½çš„æ‰§ç€ã€‚ä½ çš„çˆ±æƒ…ï¼Œè‡ªå¸¦æ»¤é•œå’ŒBGMã€‚",
    bestMatch: "ç†æ™ºç³»æ‹äºº",
    bestMatchWhy: "TAçš„ç†æ€§è®©ä½ çš„æµªæ¼«æœ‰äº†æ ¹åŸºï¼Œä½ çš„æ„Ÿæ€§åˆä¸ºTAçš„ç”Ÿæ´»æ·»äº†è‰²å½©",
    loveLanguage: "ä»ªå¼è¡¨è¾¾å‹", keyword: "æŠŠæ™®é€šçš„æ—¥å­è¿‡æˆè¯—",
    strengths: ["è®©ä¼´ä¾£è§‰å¾—è‡ªå·±æ˜¯ä¸–ç•Œä¸Šæœ€ç‰¹åˆ«çš„äºº", "å–„äºç”¨æ–‡å­—å’Œè¡ŒåŠ¨åˆ›é€ éš¾å¿˜çš„è®°å¿†", "å¯¹ç¾å’Œç»†èŠ‚çš„è¿½æ±‚è®©å…³ç³»å§‹ç»ˆä¿é²œ"],
    blindSpots: ["å¯èƒ½å¯¹å¯¹æ–¹çš„ã€Œæµªæ¼«å›åº”ã€æœŸå¾…è¿‡é«˜ï¼Œå½“æœŸå¾…è½ç©ºå®¹æ˜“å¤±æœ›", "æœ‰æ—¶è¿‡äºå…³æ³¨å½¢å¼ï¼Œå¿½ç•¥äº†çˆ±çš„æœ¬è´¨æ˜¯é™ªä¼´"],
    compatibility: { healing: 78, adventure: 82, rational: 90, romantic: 62, guardian: 70, soulmate: 85 },
    advice: [
      { title: "é™ä½å¯¹ã€Œå®Œç¾æµªæ¼«ã€çš„æ‰§å¿µ", text: "ä¸æ˜¯æ¯æ¬¡çº¦ä¼šéƒ½è¦åƒç”µå½±åœºæ™¯ã€‚å¯¹æ–¹ç¬¨æ‹™çš„è¡¨è¾¾å¯èƒ½ä¸å¤Ÿæµªæ¼«ï¼Œä½†é‚£ä»½çœŸè¯šæ¯”ä»»ä½•ä»ªå¼éƒ½çè´µã€‚" },
      { title: "å­¦ä¼šè¯»æ‡‚ä¸åŒçš„çˆ±çš„è¯­è¨€", text: "ä¸æ˜¯æ¯ä¸ªäººéƒ½æ“…é•¿ç”¨è¯­è¨€è¡¨è¾¾çˆ±ã€‚TAå¯èƒ½ä¸ä¼šå†™æƒ…ä¹¦ï¼Œä½†TAè®°å¾—ç»™ä½ ä¹°æ—©é¤â€”â€”è¿™ä¹Ÿæ˜¯çˆ±ã€‚" },
      { title: "æŠŠä»ªå¼æ„Ÿåˆ†äº«ç»™å¯¹æ–¹", text: "ä¸å…¶ç­‰å¾…å¯¹æ–¹åˆ¶é€ æµªæ¼«ï¼Œä¸å¦‚ä¸»åŠ¨æ•™TAä½ å–œæ¬¢çš„æ–¹å¼ã€‚å¥½çš„å…³ç³»éœ€è¦åŒå‘æ•™è‚²å’Œæˆé•¿ã€‚" }
    ]
  },
  guardian: {
    name: "å®ˆæŠ¤ç³»æ‹äºº", icon: "ğŸ›¡ï¸", theme: "theme-guardian",
    tags: ["å®‰å…¨æ„Ÿæ‹…å½“", "å¿ è¯šå¯é ", "ç»†æ°´é•¿æµ"],
    traits: ["è´£ä»»å¿ƒå¼º", "è¸å®ç¨³é‡", "é»˜é»˜å®ˆæŠ¤"],
    quote: "ã€Œæœ€é•¿æƒ…çš„å‘Šç™½ï¼Œæ˜¯æ—¥å¤ä¸€æ—¥çš„é™ªä¼´ã€",
    desc: "ä½ æ˜¯é‚£ç§è®©äººä¸€æƒ³åˆ°å°±è§‰å¾—å®‰å¿ƒçš„å­˜åœ¨ã€‚ä½ ä¸ä¼šè¯´å¤ªå¤šç”œè¨€èœœè¯­ï¼Œä½†ä½ çš„æ¯ä¸€ä¸ªè¡ŒåŠ¨éƒ½åœ¨æ— å£°åœ°è¯´ã€Œæˆ‘åœ¨ã€ã€‚ä½ ç›¸ä¿¡çˆ±æƒ…éœ€è¦ç»è¥ï¼Œæ„¿æ„ä¸ºä¸€æ®µå…³ç³»ä»˜å‡ºæ—¶é—´å’Œè€å¿ƒã€‚åœ¨ä½ çœ‹æ¥ï¼Œæœ€æµªæ¼«çš„äº‹å°±æ˜¯å’Œä¸€ä¸ªäººæ…¢æ…¢å˜è€ï¼ŒæŠŠå¹³å‡¡æ—¥å­è¿‡æˆå€¼å¾—å›å¿†çš„ç¯‡ç« ã€‚",
    bestMatch: "çµé­‚ç³»æ‹äºº",
    bestMatchWhy: "TAçš„æ·±åº¦æ€è€ƒè®©ä½ ç€è¿·ï¼Œä½ çš„è¸å®å®‰ç¨³åˆæ˜¯TAæœ€éœ€è¦çš„å®‰å…¨æ„Ÿ",
    loveLanguage: "è¡ŒåŠ¨å®ˆæŠ¤å‹", keyword: "æ— è®ºå‘ç”Ÿä»€ä¹ˆï¼Œæˆ‘éƒ½åœ¨",
    strengths: ["æé«˜çš„è´£ä»»æ„Ÿï¼Œè®©ä¼´ä¾£æ„Ÿåˆ°è¸å®å¯é ", "è€å¿ƒç»è¥å…³ç³»ï¼Œä¸ä¼šå› ä¸ºä¸€æ—¶çš„å›°éš¾å°±æ”¾å¼ƒ", "åœ¨å±æœºæ—¶åˆ»æ˜¯æœ€å¯é çš„åç›¾"],
    blindSpots: ["ä¸å–„è¨€è¾ï¼Œå¯¹æ–¹å¯èƒ½ä¼šè§‰å¾—ä½ ã€Œé—·ã€æˆ–ã€Œä¸å¤Ÿæµªæ¼«ã€", "å¯èƒ½è¿‡äºæ³¨é‡ç¨³å®šè€Œç¼ºå°‘æƒŠå–œæ„Ÿï¼Œå…³ç³»å®¹æ˜“è¿›å…¥èˆ’é€‚åŒº"],
    compatibility: { healing: 85, adventure: 74, rational: 75, romantic: 70, guardian: 60, soulmate: 92 },
    advice: [
      { title: "ç”¨è¯­è¨€è¯´å‡ºä½ çš„çˆ±", text: "ä½ çš„è¡ŒåŠ¨å·²ç»å¾ˆå¥½äº†ï¼Œä½†å¯¹æ–¹æœ‰æ—¶ä¹Ÿéœ€è¦å¬åˆ°ã€Œæˆ‘çˆ±ä½ ã€è¿™ä¸‰ä¸ªå­—ã€‚ä»Šå¤©å°±è¯•ç€è¯´ä¸€æ¬¡å§ï¼Œä¸ä¼šä¸¢é¢å­çš„ã€‚" },
      { title: "å¶å°”æ‰“ç ´å¸¸è§„", text: "ç¨³å®šæ˜¯ä½ çš„ä¼˜åŠ¿ï¼Œä½†å¶å°”çš„æ„å¤–ä¹Ÿå¾ˆé‡è¦ã€‚ä¸ç”¨å¤ªå¤§åŠ¨ä½œï¼Œä¸€æŸèŠ±ã€ä¸€ä¸ªæ–°é¤å…å°±å¤Ÿäº†ã€‚" },
      { title: "ä¸è¦æŠŠæ‰€æœ‰å‹åŠ›è‡ªå·±æ‰›", text: "ä½ ä¹ æƒ¯å½“ä¿æŠ¤è€…ï¼Œä½†å¥½çš„å…³ç³»æ˜¯äº’ç›¸ä¾é çš„ã€‚è®©å¯¹æ–¹ä¹Ÿæœ‰æœºä¼šç…§é¡¾ä½ ï¼ŒTAä¼šå› æ­¤æ›´çˆ±ä½ ã€‚" }
    ]
  },
  soulmate: {
    name: "çµé­‚ç³»æ‹äºº", icon: "ğŸ”®", theme: "theme-soulmate",
    tags: ["ç²¾ç¥å…±é¸£", "æ·±åº¦è¿æ¥", "çµé­‚çŸ¥å·±"],
    traits: ["å†…å¿ƒä¸°å¯Œ", "è¿½æ±‚æ·±åº¦", "ç‹¬ç«‹æ€è€ƒ"],
    quote: "ã€ŒèŒ«èŒ«äººæµ·ï¼Œæˆ‘åªä¸ºçµé­‚ç›¸ä¼¼çš„ä½ åœç•™ã€",
    desc: "ä½ è¿½æ±‚çš„ä¸æ˜¯è¡¨é¢çš„ç”œèœœï¼Œè€Œæ˜¯çµé­‚æ·±å¤„çš„éœ‡é¢¤ã€‚ä½ æ¸´æœ›ä¸€ä¸ªçœŸæ­£æ‡‚ä½ çš„äººâ€”â€”ä¸éœ€è¦å¤ªå¤šè§£é‡Šï¼Œä¸€ä¸ªçœ¼ç¥å°±å¤Ÿäº†ã€‚ä½ åœ¨æ„Ÿæƒ…ä¸­æœ‰äº›æ…¢çƒ­ï¼Œå› ä¸ºä½ åœ¨ç­‰é‚£ä¸ªé¢‘ç‡å®Œå…¨å¯¹ä¸Šçš„äººã€‚ä¸€æ—¦æ‰¾åˆ°ï¼Œä½ ä¼šç»™å‡ºæœ€æ·±æ²‰ã€æœ€çº¯ç²¹çš„çˆ±ã€‚ä½ ä»¬çš„çˆ±æƒ…ï¼Œæ˜¯æ€æƒ³çš„ç¢°æ’å’Œçµé­‚çš„å…±èˆã€‚",
    bestMatch: "å®ˆæŠ¤ç³»æ‹äºº",
    bestMatchWhy: "TAçš„ç¨³é‡ç»™äº†ä½ å®‰å…¨æ„Ÿå»æ•å¼€å¿ƒæ‰‰ï¼Œä½ çš„æ·±åº¦åˆè®©TAè§‰å¾—é‡åˆ°äº†çŸ¥å·±",
    loveLanguage: "ç²¾ç¥å…±é¸£å‹", keyword: "ä½ æ˜¯å”¯ä¸€æ‡‚æˆ‘çš„äºº",
    strengths: ["èƒ½ç»™äºˆä¼´ä¾£æ·±å±‚æ¬¡çš„ç†è§£å’Œå…±é¸£", "å…³ç³»è´¨é‡æé«˜ï¼Œä¸æµäºè¡¨é¢", "å¿ è¯šä¸”ä¸“ä¸€ï¼Œä¸€æ—¦è®¤å®šä¾¿å…¨èº«å¿ƒæŠ•å…¥"],
    blindSpots: ["è¿‡é«˜çš„ç²¾ç¥å¥‘åˆæ ‡å‡†å¯èƒ½è®©ä½ é”™è¿‡ã€Œä¸å®Œç¾ä½†å¾ˆå¥½ã€çš„äºº", "æ…¢çƒ­ç‰¹è´¨å¯èƒ½è®©å¯¹æ–¹åœ¨åˆæœŸè¯¯ä»¥ä¸ºä½ ä¸æ„Ÿå…´è¶£"],
    compatibility: { healing: 74, adventure: 78, rational: 82, romantic: 85, guardian: 92, soulmate: 58 },
    advice: [
      { title: "ç»™å½¼æ­¤æˆé•¿çš„ç©ºé—´", text: "çµé­‚ä¼´ä¾£ä¸æ˜¯ä¸€å¼€å§‹å°±100%å¥‘åˆçš„ã€‚å…è®¸å¯¹æ–¹æœ‰ä½ ä¸ç†è§£çš„éƒ¨åˆ†ï¼Œåœ¨ç£¨åˆä¸­åŠ æ·±è¿æ¥ï¼Œæ¯”å¯»æ‰¾å®Œç¾åŒ¹é…æ›´ç°å®ã€‚" },
      { title: "ä¸»åŠ¨é‡Šæ”¾ä¿¡å·", text: "ä½ çš„æ…¢çƒ­è®©äººéš¾ä»¥é è¿‘ã€‚åœ¨å¿ƒåŠ¨çš„æ—¶å€™ï¼Œè¯•ç€ä¸»åŠ¨ä¸€ç‚¹â€”â€”å“ªæ€•åªæ˜¯å¤šçœ‹å¯¹æ–¹ä¸€çœ¼ã€å¤šå›ä¸€å¥æ¶ˆæ¯ã€‚" },
      { title: "ç”¨èº«ä½“è¯­è¨€è¡¥å……ç²¾ç¥è¿æ¥", text: "ä½ æ“…é•¿ç²¾ç¥å±‚é¢çš„æ²Ÿé€šï¼Œä½†åˆ«å¿˜äº†è‚¢ä½“æ¥è§¦çš„åŠ›é‡ã€‚ä¸€ä¸ªæ‹¥æŠ±ã€ä¸€æ¬¡ç‰µæ‰‹ï¼Œæœ‰æ—¶èƒœè¿‡åƒè¨€ä¸‡è¯­ã€‚" }
    ]
  }
};

// ===== State =====
let currentQ = 0;
let scores = {};

function resetScores() {
  scores = { healing: 0, adventure: 0, rational: 0, romantic: 0, guardian: 0, soulmate: 0 };
}

// ===== Navigation =====
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function startQuiz() {
  currentQ = 0;
  resetScores();
  showScreen('quizScreen');
  renderQuestion();
}

// ===== Quiz =====
function renderQuestion() {
  const q = questions[currentQ];
  const total = questions.length;
  const pct = ((currentQ) / total * 100);

  document.getElementById('progressBar').style.width = pct + '%';
  document.getElementById('progressText').textContent = `${currentQ + 1} / ${total}`;

  const container = document.getElementById('questionContainer');
  container.innerHTML = `
    <div class="question-num">Q${currentQ + 1}</div>
    <div class="question-text">${q.q}</div>
    <div class="options">
      ${q.opts.map((opt, i) => `
        <button class="option-btn" onclick="selectOption(${i})">${opt.text}</button>
      `).join('')}
    </div>
  `;
  // Re-trigger animation
  container.style.animation = 'none';
  container.offsetHeight;
  container.style.animation = 'fadeIn 0.4s ease';
}

function selectOption(idx) {
  const btns = document.querySelectorAll('.option-btn');
  btns.forEach(b => b.classList.remove('selected'));
  btns[idx].classList.add('selected');

  const opt = questions[currentQ].opts[idx];
  for (const [type, val] of Object.entries(opt.scores)) {
    scores[type] += val;
  }

  setTimeout(() => {
    currentQ++;
    if (currentQ < questions.length) {
      renderQuestion();
    } else {
      document.getElementById('progressBar').style.width = '100%';
      showLoading();
    }
  }, 300);
}

// ===== Loading =====
function showLoading() {
  showScreen('loadingScreen');
  setTimeout(() => showResult(), 2200);
}

// ===== Global result state =====
let resultType = null;
let resultPct = 0;

// ===== Result =====
function showResult() {
  let maxType = 'healing', maxScore = 0;
  for (const [type, score] of Object.entries(scores)) {
    if (score > maxScore) { maxScore = score; maxType = type; }
  }
  const rawPct = (maxScore / 16) * 100;
  const percentage = Math.min(98, Math.max(75, Math.round(rawPct * 0.3 + 70)));
  resultType = maxType;
  resultPct = percentage;
  const t = types[maxType];
  const rarePct = Math.min(12, Math.max(3, Math.round(100 - percentage + Math.random() * 5)));

  // Build color for compatibility bars
  const compatColors = {
    healing: '#f59e0b', adventure: '#ef4444', rational: '#3b82f6',
    romantic: '#a855f7', guardian: '#10b981', soulmate: '#6366f1'
  };

  const resultHTML = `
    <!-- ===== SHARE CARD (screenshot-optimized) ===== -->
    <div class="share-card ${t.theme}" id="shareCard">
      <div class="share-card-inner">
        <div class="share-rank">å…¨ç½‘ä»… ${rarePct}% åŒæ¬¾æ‹äºº Â· ç¨€æœ‰äººæ ¼</div>
        <div class="share-pct">${percentage}<span class="share-pct-sign">%</span></div>
        <div class="share-type-icon">${t.icon}</div>
        <div class="share-type-name">${t.name}</div>
        <div class="share-quote">${t.quote}</div>
        <div class="share-tags">
          ${t.tags.map(tag => `<span class="share-tag">${tag}</span>`).join('')}
          ${t.traits.map(tag => `<span class="share-tag">${tag}</span>`).join('')}
        </div>
        <div class="radar-wrap"><canvas id="radarCanvas"></canvas></div>
        <div class="share-footer">
          <div class="share-footer-brand">æ‹çˆ±äººæ ¼å›¾é‰´<br><span style="font-size:10px;opacity:0.7">æ‰«ç æµ‹æµ‹ä½ çš„æ‹çˆ±äººæ ¼</span></div>
          <div class="share-footer-qr">æ‰«ç <br>æµ‹è¯•</div>
        </div>
      </div>
    </div>

    <!-- Share CTA -->
    <div class="share-cta">
      <div class="share-cta-text">æˆªå›¾åˆ†äº«åˆ°æœ‹å‹åœˆï¼Œçœ‹çœ‹å¥½å‹æ˜¯ä»€ä¹ˆæ‹çˆ±äººæ ¼</div>
      <div class="share-cta-btns">
        <button class="btn-retest" onclick="startQuiz()">é‡æ–°æµ‹è¯•</button>
        <button class="btn-save" onclick="shareResult()">ä¿å­˜åˆ†äº«</button>
      </div>
    </div>

    <!-- ===== FREE BRIEF ===== -->
    <div class="brief-section">
      <div class="brief-card">
        <div class="brief-card-title">âœ¨ äººæ ¼è§£è¯»</div>
        <p>${t.desc}</p>
      </div>
      <div class="brief-card">
        <div class="brief-card-title">ğŸ’˜ æ‹çˆ±æ¡£æ¡ˆ</div>
        <div class="brief-row">
          <span class="be">ğŸ’¬</span><span class="bl">çˆ±æƒ…è¯­è¨€</span><span class="bv">${t.loveLanguage}</span>
        </div>
        <div class="brief-row">
          <span class="be">ğŸ”‘</span><span class="bl">å…³é”®è¯</span><span class="bv">${t.keyword}</span>
        </div>
        <div class="brief-row">
          <span class="be">ğŸ’•</span><span class="bl">æœ€ä½³CP</span><span class="bv">${t.bestMatch}</span>
        </div>
      </div>
    </div>

    <!-- ===== PAID SECTION ===== -->
    <div class="paid-section" id="paidSection">
      <div class="paid-header">
        <h3>æ·±åº¦æ‹çˆ±æŠ¥å‘Š</h3>
        <p>è§£é”ä¸“å±äºä½ çš„å®Œæ•´æ‹çˆ±åˆ†æä¸å»ºè®®</p>
      </div>

      <!-- Preview: strengths (partially visible) -->
      <div class="locked-card is-locked">
        <div class="brief-card-title">ğŸ’ª æ‹çˆ±ä¼˜åŠ¿</div>
        <div class="locked-content">
          <div class="report-item"><span class="report-item-icon">âœ…</span><span class="report-item-text">${t.strengths[0]}</span></div>
          <div class="report-item"><span class="report-item-icon">âœ…</span><span class="report-item-text">${t.strengths[1]}</span></div>
          <div class="report-item"><span class="report-item-icon">âœ…</span><span class="report-item-text">${t.strengths[2]}</span></div>
        </div>
        <div class="lock-overlay"><span class="lock-badge">ğŸ”’ ä»˜è´¹è§£é”</span></div>
      </div>

      <!-- Preview: blind spots -->
      <div class="locked-card is-locked">
        <div class="brief-card-title">âš ï¸ æ‹çˆ±ç›²åŒº</div>
        <div class="locked-content">
          <div class="report-item"><span class="report-item-icon">ğŸ’¡</span><span class="report-item-text">${t.blindSpots[0]}</span></div>
          <div class="report-item"><span class="report-item-icon">ğŸ’¡</span><span class="report-item-text">${t.blindSpots[1]}</span></div>
        </div>
        <div class="lock-overlay"><span class="lock-badge">ğŸ”’ ä»˜è´¹è§£é”</span></div>
      </div>

      <!-- Preview: compatibility -->
      <div class="locked-card is-locked">
        <div class="brief-card-title">ğŸ”— å…¨ç±»å‹åŒ¹é…åº¦</div>
        <div class="locked-content">
          ${Object.entries(types).map(([k, v]) => `
            <div class="compat-row">
              <span class="compat-name">${v.icon} ${v.name.replace('æ‹äºº','')}</span>
              <div class="compat-bar-bg"><div class="compat-bar" style="width:0%;background:${compatColors[k]}"></div></div>
              <span class="compat-pct" style="color:${compatColors[k]}">??%</span>
            </div>
          `).join('')}
        </div>
        <div class="lock-overlay"><span class="lock-badge">ğŸ”’ ä»˜è´¹è§£é”</span></div>
      </div>

      <!-- Unlock CTA -->
      <div class="unlock-cta" id="unlockCta">
        <div class="unlock-limited">é™æ—¶ç‰¹æƒ </div>
        <div class="unlock-price-row">
          <span class="unlock-price">Â¥1.99</span>
          <span class="unlock-price-orig">Â¥9.90</span>
        </div>
        <div class="unlock-list">
          <div class="unlock-list-item">æ‹çˆ±ä¼˜åŠ¿æ·±åº¦è§£æ</div>
          <div class="unlock-list-item">æ‹çˆ±ç›²åŒºé¢„è­¦</div>
          <div class="unlock-list-item">ä¸6ç§äººæ ¼çš„åŒ¹é…åº¦</div>
          <div class="unlock-list-item">3æ¡ä¸“å±æ‹çˆ±å»ºè®®</div>
          <div class="unlock-list-item">æ²Ÿé€šé£æ ¼æŒ‡å—</div>
        </div>
        <button class="unlock-btn" onclick="openPay()">è¾“å…¥è§£é”ç  Â· æŸ¥çœ‹å®Œæ•´æŠ¥å‘Š</button>
        <div class="unlock-count">å·²æœ‰ 12,386 äººè§£é”</div>
      </div>
    </div>

    <!-- ===== UNLOCKED REPORT (hidden by default) ===== -->
    <div class="report-unlocked" id="reportUnlocked">
      <div class="report-card" style="animation-delay:0.1s">
        <div class="report-card-title">ğŸ’ª æ‹çˆ±ä¼˜åŠ¿</div>
        ${t.strengths.map(s => `<div class="report-item"><span class="report-item-icon">âœ…</span><span class="report-item-text">${s}</span></div>`).join('')}
      </div>
      <div class="report-card" style="animation-delay:0.2s">
        <div class="report-card-title">âš ï¸ æ‹çˆ±ç›²åŒº</div>
        ${t.blindSpots.map(s => `<div class="report-item"><span class="report-item-icon">ğŸ’¡</span><span class="report-item-text">${s}</span></div>`).join('')}
      </div>
      <div class="report-card" style="animation-delay:0.3s">
        <div class="report-card-title">ğŸ”— å…¨ç±»å‹åŒ¹é…åº¦</div>
        ${Object.entries(types).map(([k, v]) => `
          <div class="compat-row">
            <span class="compat-name">${v.icon} ${v.name.replace('æ‹äºº','')}</span>
            <div class="compat-bar-bg"><div class="compat-bar compat-anim" data-w="${t.compatibility[k]}" style="width:0%;background:${compatColors[k]}"></div></div>
            <span class="compat-pct" style="color:${compatColors[k]}">${t.compatibility[k]}%</span>
          </div>
        `).join('')}
      </div>
      <div class="report-card" style="animation-delay:0.4s">
        <div class="report-card-title">ğŸ’Œ ä¸“å±æ‹çˆ±å»ºè®®</div>
        ${t.advice.map(a => `
          <div class="advice-box">
            <div class="advice-box-title">${a.title}</div>
            <div class="advice-box-text">${a.text}</div>
          </div>
        `).join('')}
      </div>
    </div>
  `;

  document.getElementById('resultScreen').innerHTML = resultHTML;
  showScreen('resultScreen');
  // Draw radar after DOM insert
  setTimeout(() => drawRadar('radarCanvas', scores), 100);
}

// ===== Share =====
const shareLink = 'https://ameliamm001.github.io/love-personality-test/';
const captions = {
  wechat: () => `æˆ‘æµ‹å‡ºæ¥æ˜¯ã€Œ${types[resultType].name}ã€ï¼åŒ¹é…åº¦${resultPct}%ï¼Œå¤ªå‡†äº†å§ï¼\nä½ ä¹Ÿæ¥æµ‹æµ‹ä½ æ˜¯ä»€ä¹ˆæ‹çˆ±äººæ ¼ğŸ‘‡\n${shareLink}`,
  red: () => `å¤©å‘è¿™ä¸ªæ‹çˆ±äººæ ¼æµ‹è¯•ä¹Ÿå¤ªå‡†äº†å§ï¼ï¼\næˆ‘å±…ç„¶æ˜¯ã€Œ${types[resultType].name}ã€${types[resultType].icon}\n${types[resultType].quote}\n\nå§å¦¹ä»¬å¿«æ¥æµ‹æµ‹ä½ æ˜¯ä»€ä¹ˆç±»å‹ï½\n\n#æ‹çˆ±äººæ ¼ #æ€§æ ¼æµ‹è¯• #æ‹çˆ±äººæ ¼å›¾é‰´ #è¶£å‘³æµ‹è¯• #å¿ƒç†æµ‹è¯•`,
  douyin: () => `æµ‹äº†ä¸€ä¸‹æ‹çˆ±äººæ ¼ï¼Œæˆ‘æ˜¯ã€Œ${types[resultType].name}ã€${types[resultType].icon}ï¼ŒåŒ¹é…åº¦${resultPct}%ï¼\n${types[resultType].quote}\nä½ æ˜¯å“ªç§æ‹çˆ±äººæ ¼ï¼Ÿè¯„è®ºåŒºå‘Šè¯‰æˆ‘ï½\n\n#æ‹çˆ±äººæ ¼å›¾é‰´ #æ€§æ ¼æµ‹è¯• #æ‹çˆ±äººæ ¼ #å¿ƒç†æµ‹è¯•`,
  xianyu: () => `ã€æ‹çˆ±äººæ ¼å›¾é‰´ã€‘è¶£å‘³æ€§æ ¼æµ‹è¯•\næµ‹æµ‹ä½ æ˜¯å“ªç§æ‹çˆ±äººæ ¼ï¼Ÿ6ç§ç±»å‹ç­‰ä½ è§£é”ï¼\næˆ‘æµ‹å‡ºæ¥æ˜¯ã€Œ${types[resultType].name}ã€ï¼Œå‡†åˆ°ç¦»è°±ï¼\n${shareLink}`
};

function shareResult() {
  document.getElementById('shareImgTip').classList.remove('show');
  document.getElementById('shareCaptionArea').classList.remove('show');
  document.getElementById('shareSheet').classList.add('show');
}

function closeShare() {
  document.getElementById('shareSheet').classList.remove('show');
}

function shareTo(platform) {
  // Show caption
  const caption = captions[platform]();
  document.getElementById('shareCaptionText').textContent = caption;
  const labelMap = { wechat: 'å¾®ä¿¡æ–‡æ¡ˆ', red: 'å°çº¢ä¹¦æ–‡æ¡ˆ', douyin: 'æŠ–éŸ³æ–‡æ¡ˆ', xianyu: 'é—²é±¼æ–‡æ¡ˆ' };
  document.getElementById('shareCaptionLabel').textContent = labelMap[platform];
  document.getElementById('shareCaptionArea').classList.add('show');

  // Generate share image
  const card = document.getElementById('shareCard');
  if (card && typeof html2canvas !== 'undefined') {
    document.getElementById('shareImgTip').classList.remove('show');
    html2canvas(card, {
      scale: 2,
      useCORS: true,
      backgroundColor: null,
      borderRadius: 24
    }).then(canvas => {
      const img = document.getElementById('shareImgPreview');
      img.src = canvas.toDataURL('image/png');
      document.getElementById('shareImgTip').classList.add('show');
    });
  }
}

function copyCaption() {
  const text = document.getElementById('shareCaptionText').textContent;
  navigator.clipboard.writeText(text).then(() => {
    showToast('æ–‡æ¡ˆå·²å¤åˆ¶');
  }).catch(() => {
    // Fallback
    const ta = document.createElement('textarea');
    ta.value = text;
    document.body.appendChild(ta);
    ta.select();
    document.execCommand('copy');
    document.body.removeChild(ta);
    showToast('æ–‡æ¡ˆå·²å¤åˆ¶');
  });
}

// ===== Unlock Code System =====
// Code format: LV + 6 digits, valid when (d1*7 + d2*3 + d3*5 + d4*2 + d5*8 + d6*4) % 10 === 7
function validateCode(code) {
  if (!/^LV\d{6}$/.test(code)) return false;
  const ds = code.slice(2).split('').map(Number);
  const weights = [7, 3, 5, 2, 8, 4];
  const sum = ds.reduce((s, d, i) => s + d * weights[i], 0);
  return sum % 10 === 7;
}

function openPay() {
  document.getElementById('qrPayView').style.display = '';
  document.getElementById('codeInputView').style.display = 'none';
  document.getElementById('payModal').classList.add('show');
}
function closePay() {
  document.getElementById('payModal').classList.remove('show');
}
function showCodeInput() {
  document.getElementById('qrPayView').style.display = 'none';
  document.getElementById('codeInputView').style.display = '';
  document.getElementById('codeInput').value = '';
  document.getElementById('codeError').textContent = '';
  setTimeout(() => document.getElementById('codeInput').focus(), 200);
}
function showQrPay() {
  document.getElementById('qrPayView').style.display = '';
  document.getElementById('codeInputView').style.display = 'none';
}
function confirmPaid() {
  closePay();
  showToast('è§£é”æˆåŠŸï¼');
  localStorage.setItem('lv_unlocked', '1');
  unlockReport();
}
function submitCode() {
  const code = document.getElementById('codeInput').value.trim().toUpperCase();
  if (!code) {
    document.getElementById('codeError').textContent = 'è¯·è¾“å…¥è§£é”ç ';
    return;
  }
  if (!validateCode(code)) {
    document.getElementById('codeError').textContent = 'è§£é”ç æ— æ•ˆï¼Œè¯·æ£€æŸ¥åé‡è¯•';
    document.getElementById('codeInput').style.borderColor = '#ef4444';
    setTimeout(() => { document.getElementById('codeInput').style.borderColor = '#e5e7eb'; }, 1500);
    return;
  }
  // Check if code already used (localStorage)
  const usedCodes = JSON.parse(localStorage.getItem('lv_used_codes') || '[]');
  if (usedCodes.includes(code)) {
    document.getElementById('codeError').textContent = 'è¯¥è§£é”ç å·²è¢«ä½¿ç”¨';
    return;
  }
  // Mark as used
  usedCodes.push(code);
  localStorage.setItem('lv_used_codes', JSON.stringify(usedCodes));

  closePay();
  showToast('è§£é”æˆåŠŸï¼');
  unlockReport();
}

function unlockReport() {
  document.getElementById('paidSection').style.display = 'none';
  const report = document.getElementById('reportUnlocked');
  report.classList.add('show');
  setTimeout(() => {
    report.querySelectorAll('.compat-anim').forEach(bar => {
      bar.style.width = bar.dataset.w + '%';
    });
  }, 300);
  setTimeout(() => {
    report.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 200);
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}
</script>
</body>
</html>
